<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- <link href="https://www.gov.tw/css/chatbottext.css" rel="stylesheet" type="text/css" /> -->
    <link href="./chatbottext.css" rel="stylesheet" type="text/css" />
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script src="https://www.gov.tw/Scripts/jquery-ui.min.js?1"></script>
    <!-- <script src="https://www.gov.tw/js/marqueeHorizontal.js?version=v2"></script> -->

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>

    <style type="text/css">
      .base-extend {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 4;
        background-color: #fff;
        background: linear-gradient(-90deg, #fff 0%, #fff 50%, #e6e6e6 100%);
        background: -moz-linear-gradient(
          -90deg,
          rgba(255, 255, 255, 0.794) 0%,
          #fff 50%,
          #e6e6e6 100%
        );
        background: -webkit-linear-gradient(
          -90deg,
          #fff 0%,
          #fff 50%,
          #e6e6e6 100%
        );
        background: -o-linear-gradient(-90deg, #fff 0%, #fff 50%, #e6e6e6 100%);
        min-height: 57px;
      }

      .base-extend .list-text.share.e-book .hd a {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        transition: 150ms;
        border-radius: 100%;
        background-image: url(https://www.gov.tw/images/icon-pic/main-ebook.png?1583227606);
        background-repeat: no-repeat;
        background-position: center;
        border-radius: 100%;
        border: 2px solid #343434;
        width: 40px;
        height: 40px;
        z-index: 3;
        transition: 0.2s;
        overflow: hidden;
        text-indent: -9999px;
      }

      .base-extend .list-text.link {
        right: 136px !important;
      }

      .list-text.font-size {
        right: 96px !important;
      }

      .base-extend .list-text.share {
        right: 48px !important;
      }

      .base-extend .list-text.share.e-book {
        right: 0px !important;
      }
    </style>
    <style type="text/css">
      .autocomplete-items {
        /*position: absolute;*/
        border: 1px solid #d4d4d4;
        border-bottom: none;
        border-top: none;
        z-index: 99;
        /*position the autocomplete items to be the same width as the container:*/
        top: 100%;
        left: 0;
        right: 0;
      }

      .autocomplete-items div {
        padding: 10px;
        cursor: pointer;
        background-color: #fff;
        border-bottom: 1px solid #d4d4d4;
      }

      /*when hovering an item:*/
      .autocomplete-items div:hover {
        background-color: #e9e9e9;
      }

      a.e-book-close {
        position: relative;
        right: -112px;
        top: -11px;
      }
      /*when navigating through the items using the arrow keys:*/
      .autocomplete-active {
        background-color: DodgerBlue !important;
        color: #ffffff;
      }
    </style>
  </head>

  <body>
    <div class="sys-root">
      <div class="group base-extend">
        <div class="in">
          <div class="list-text share e-book" style="position: inherit">
            <div class="in">
              <div class="hd">
                <div class="in">
                  <div>
                    <span
                      ><a
                        href="#"
                        class="e-book-open"
                        title="E-GOV小幫手"
                        @click.prevent="isebookicon =! isebookicon"
                        >E-GOV小幫手</a
                      ></span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        class="area-editor default e-book"
        data-addparentgroup="False"
        data-anchor=""
        data-bgclass="e-book"
        data-bgcolor="#0000ffff"
        data-child="1"
        data-groupname=""
        data-groupsn="2273"
        data-index="4"
        data-isgroup="true"
        data-margin_bottom="0"
        data-margin_defaultsetting="false"
        data-margin_left="0"
        data-margin_right="0"
        data-margin_top="0"
        data-menuwidth=""
        data-setlen="0"
        data-sitesmodulesn="6"
        data-sort="8"
        data-tabtype="0"
        data-type="0"
        data-widthdesktop="0"
        data-widthmobile="0"
        data-widthpad="0"
        id="Group_2273_YYpUwxTtPL"
      >
        <div class="in">
          <div class="ct">
            <div class="in">
              <!-- 小幫手對話框展開 -->
              <div class="talk_con" v-show="istalkcon">
                <div class="talk_header">
                  <span class="chat_title">我的E政府 智能幫手</span>
                  <a
                    class="close"
                    @click.prevent="istalkcon =!istalkcon,isebookicon =! isebookicon"
                    >X</a
                  >
                  <div class="information">
                    <!-- 原html沒有 -->
                    <a
                      class="btn"
                      title="&zwnj;"
                      @click="isinformation = !isinformation"
                      ><p style="display: none">&zwnj;</p></a
                    >
                    <!-- finish -->
                    <div
                      class="box"
                      v-if="isinformation"
                      style="display: block"
                    >
                      <ul>
                        <li class="btn_statify">
                          <span
                            ><a
                              title="滿意度調查"
                              @click="btn_statify"
                              target="_blank"
                              >滿意度調查</a
                            ></span
                          >
                        </li>
                        <li class="btn_privacy">
                          <span
                            ><a
                              href="cp.aspx?n=16"
                              target="_blank"
                              title="隱私權保護政策"
                              >隱私權保護政策</a
                            ></span
                          >
                        </li>
                        <li class="btn_description">
                          <span
                            ><a
                              @click="btn_des_open"
                              title="服務說明"
                              target="_blank"
                              >服務說明</a
                            ></span
                          >
                        </li>
                      </ul>
                    </div>
                  </div>

                  <!-- 設定按紐開啟 -->
                  <div class="set_up">
                    <!-- 原html沒有 -->
                    <a class="btn" title="&zwnj;" @click="isset_up = !isset_up"
                      ><p style="display: none">&zwnj;</p></a
                    >
                    <div class="box" v-if="isset_up" style="display: block">
                      <div class="sort">
                        <div class="title">字型</div>
                        <ul class="font">
                          <li
                            class="small"
                            data-index="1"
                            :class="{'is-active': fontSize == '0.5rem'}"
                          >
                            <span
                              ><a title="小字級" @click="fontSize='0.5rem'"
                                >小</a
                              ></span
                            >
                          </li>
                          <li
                            class="medium"
                            :class="{'is-active': fontSize == '1rem'}"
                          >
                            <span
                              ><a title="中字級" @click="fontSize='1rem'"
                                >中</a
                              ></span
                            >
                          </li>
                          <li
                            class="large"
                            :class="{'is-active': fontSize == '1.5rem'}"
                          >
                            <span
                              ><a title="大字級" @click="fontSize='1.5rem'"
                                >大</a
                              ></span
                            >
                          </li>
                        </ul>
                      </div>
                      <!-- 不使用 -->
                      <!-- <div class="sort">
                <div class="title">角色</div>
                <ul class="user">
                  <li v-for="(item,key) in roleALL" :key="key">
                    <input
                      name="checkRole"
                      type="checkbox"
                      :value="item.value"
                      v-model="Rolevalues"
                    />{{ item.name }}
                  </li>
                </ul>
              </div>

              <div class="btn">
                <a
                  class="talk_sub"
                  id="btn_RoleSet"
                  title="確定"
                  @click="RoleSet"
                  >確定</a
                >
                <a
                  class="talk_sub"
                  id="btn_RoleReset"
                  title="重設"
                  @click="RoleReSet"
                  >重設</a
                >
              </div> -->
                      <!-- finish -->
                    </div>
                  </div>
                </div>
                <!-- 上方按鈕開啟內容 -->
                <div class="informationBlock">
                  <div class="statify" style="display: none">
                    <div class="title">滿意度調查</div>
                    <div>
                      <div class="chat-footer">
                        <div
                          class="area-form vote"
                          data-child="1"
                          data-type="0"
                          data-votesatisfiedkey="B554CCD93F7D56F9"
                        >
                          <div class="in">
                            <div class="hd">
                              <div class="in">
                                <div data-index="0">&nbsp;</div>
                              </div>
                            </div>
                            <div class="ct">
                              <div class="in">
                                <div class="essay" data-step="1" style="">
                                  <div class="caption">&nbsp;</div>
                                </div>

                                <div
                                  class="area-form vote"
                                  data-step="1"
                                  style=""
                                >
                                  <span
                                    >請問您對於智能客服「E-GOV小幫手」這次提供的服務整體滿意度為何?（五顆星＝非常滿意）
                                  </span>
                                  <div class="fieldset">
                                    <input
                                      data-satisfiedvalue="1"
                                      id="Satisfied_0"
                                      name="Satisfied"
                                      title="1顆星"
                                      type="radio"
                                    />
                                    <label for="Satisfied_0">1顆星</label>
                                    <input
                                      data-satisfiedvalue="2"
                                      id="Satisfied_1"
                                      name="Satisfied"
                                      title="2顆星"
                                      type="radio"
                                    />
                                    <label for="Satisfied_1">2顆星</label>
                                    <input
                                      data-satisfiedvalue="3"
                                      id="Satisfied_2"
                                      name="Satisfied"
                                      title="3顆星"
                                      type="radio"
                                    />
                                    <label for="Satisfied_2">3顆星</label>
                                    <input
                                      data-satisfiedvalue="4"
                                      id="Satisfied_3"
                                      name="Satisfied"
                                      title="4顆星"
                                      type="radio"
                                    />
                                    <label for="Satisfied_3">4顆星</label>
                                    <input
                                      checked="checked"
                                      data-satisfiedvalue="5"
                                      id="Satisfied_4"
                                      name="Satisfied"
                                      title="5顆星"
                                      type="radio"
                                    />
                                    <label for="Satisfied_4">5顆星</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <textarea
                        cols="50"
                        id="txt_satisfied"
                        placeholder="請您留下寶貴意見，我們將會持續努力提供更完美的服務，謝謝！（限50字，選填）"
                        rows="4"
                      ></textarea>
                    </div>
                    <div class="btn">
                      <a
                        class="talk_sub"
                        id="btn_submit"
                        title="送出"
                        @click="satisfiedSet"
                        >送出</a
                      >
                      <a
                        class="talk_sub"
                        id="btn_cancel"
                        title="取消"
                        @click="satisfiedCancel"
                        >取消</a
                      >
                    </div>
                  </div>
                  <!-- 個資目前沒用到 -->
                  <!-- <div class="privacy" style="display: none">
            <div class="title">個資保密聲明</div>
            <div class="content">
              本網站使用前瞻技術提供更好的使用體驗，同時尊重使用者隱私，為維護您的權益，開始使用前懇請事先詳閱「
              <a href="https://www.gov.tw/cp.aspx?n=16" title="隱私權保護政策"
                >隱私權保護政策</a
              >」
              。當您點擊「我同意」時，視同您已充分了解並同意本網站智能客服「E-GOV小幫手」開始蒐集與處理您所提供的資料，蒐集範圍將包含使用COOKIE記住您的角色與當次對話紀錄。
            </div>
            <div class="btn">
              <a class="talk_sub" id="btn_agree" title="我同意">我同意</a>
              <a class="talk_sub" id="btn_disagree" title="我不同意"
                >我不同意</a
              >
            </div>
          </div> -->
                  <!-- finish -->

                  <div class="description" style="display: none">
                    <div class="title">服務說明</div>
                    <div class="content">
                      <div class="subtitle">智能文字交談服務時間</div>
                      <div class="text">24小時全年無休</div>
                      <div class="subtitle">服務範圍</div>
                      <div class="text">
                        E-GOV小幫手是由AI提供，因此可能會出現意外和錯誤。
                      </div>
                    </div>
                    <div class="btn">
                      <a
                        class="talk_sub"
                        id="btn_close"
                        title="我知道了"
                        @click="btn_close"
                        >我知道了</a
                      >
                    </div>
                  </div>
                </div>

                <div class="talk_show" id="words" :style="fontSizeStyle"></div>

                <div
                  class="talk_show"
                  id="tempwords"
                  style="top: -100px; height: 100px !important"
                  :style="fontSizeStyle"
                >
                  &nbsp;
                </div>

                <!-- 熱門不使用 -->
                <!-- <div class="hot_list" :style="{ 'display':'block' }" v-show="isHot">
            <div class="title">
              下列為其他使用者常搜尋的關鍵字
              <a
                class="talk_sub talkhotclose"
                id="talkhotclose"
                @click.prevent="isHot = !isHot"
                title="關閉"
                >X</a
              >
            </div>

            <ul></ul>
          </div> -->
                <!-- finish -->
                <div class="auto_complete">&nbsp;</div>

                <div class="talk_input">
                  <!-- 熱門不使用 -->
                  <!-- <a
            class="talk_sub hot"
            id="talkhot"
            title="熱門"
            @click.prevent="isHot = !isHot"
            :class="{ 'is-active' : isHot }"
            >熱門</a
          > -->
                  <!-- finish -->
                  <input
                    class="talk_word"
                    id="talkwords"
                    type="text"
                    @keyup.enter="TalkSub"
                    v-model="Q_Now"
                  />
                  <a class="talk_sub" id="talksub" title="傳送" @click="TalkSub"
                    >傳送</a
                  >
                </div>
              </div>

              <!-- 開始小幫手圖示 -->
              <div
                class="area-editor default e-book-icon"
                data-addparentgroup="False"
                data-anchor=""
                data-bgclass="e-book-icon"
                data-bgcolor="#0000ffff"
                data-child="1"
                data-groupname=""
                data-groupsn="2274"
                data-index="5"
                data-isgroup="true"
                data-margin_bottom="0"
                data-margin_defaultsetting="false"
                data-margin_left="0"
                data-margin_right="0"
                data-margin_top="0"
                data-menuwidth=""
                data-setlen="0"
                data-sitesmodulesn="6"
                data-sort="10"
                data-tabtype="0"
                data-type="0"
                data-widthdesktop="0"
                data-widthmobile="0"
                data-widthpad="0"
                id="Group_2274_LkeNWcGYvv"
                v-show="isebookicon"
              >
                <div class="in">
                  <div class="ct">
                    <div class="in">
                      <p>
                        <a
                          class="e-book-close"
                          @click.prevent="isebookicon =! isebookicon"
                          title="關閉E-GOV小幫手"
                          >X</a
                        >
                        <a
                          class="CustomerService"
                          title="智能幫手"
                          @click.prevent="istalkcon =!istalkcon;isebookicon =! isebookicon"
                          >智能幫手</a
                        >
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Vue 2.x
      const vm = new Vue({
        data: {
          isebookicon: false,
          isinformation: false,
          istalkcon: false,
          isset_up: false,
          IsSatisfy: false,
          fontSize: "1rem",
          Q_Now: "",
          guid: "",
          chatLogs: [],
          notfundcount: 0,
          lifeevent: [
            {
              ChildrenObj: [
                { SN: 10, Name: "小孩未滿2歲" },
                { SN: 11, Name: "小孩2到5歲" },
                { SN: 12, Name: "小孩6到7歲" },
              ],
              picurl: "images/chat-bg01.jpg",
              SN: 8,
              Name: "出生",
            },
            {
              ChildrenObj: [
                { SN: 14, Name: "幼兒教育" },
                { SN: 15, Name: "國民中小學" },
                { SN: 16, Name: "高中及高職" },
                { SN: 17, Name: "大學及研究所" },
              ],
              picurl: "images/chat-bg02.jpg",
              SN: 13,
              Name: "就學",
            },
            {
              ChildrenObj: [
                { SN: 22, Name: "求職" },
                { SN: 23, Name: "在職" },
                { SN: 24, Name: "離職" },
                { SN: 25, Name: "創業" },
                { SN: 26, Name: "退休" },
              ],
              picurl: "images/chat-bg03.jpg",
              SN: 19,
              Name: "就業",
            },
            {
              ChildrenObj: [
                { SN: 27, Name: "55到59歲老人" },
                { SN: 28, Name: "60到64歲老人" },
                { SN: 29, Name: "65歲以上老人" },
              ],
              picurl: "images/chat-bg04.jpg",
              SN: 20,
              Name: "就養",
            },
            {
              ChildrenObj: [
                { SN: 30, Name: "臨終規劃" },
                { SN: 31, Name: "往生" },
                { SN: 32, Name: "身後事處理" },
              ],
              picurl: "images/chat-bg05.jpg",
              SN: 21,
              Name: "終老",
            },
          ],
        },
        methods: {
          btn_des_open: function () {
            $(".btn_description").click(function () {
              $(".information").find(".box").slideToggle("fast");
              $(".informationBlock>div").hide();
              $(".informationBlock>.description").show();
            });
          },
          btn_close: function () {
            $(".informationBlock>div").hide();
            vm.isinformation = !vm.isinformation;
          },
          btn_statify: function (e) {
            $(".information>.box").slideToggle("fast");
            $(".informationBlock>div").hide();
            $(".informationBlock>.statify").show();
          },
          satisfiedSet: function () {
            if ($("#txt_satisfied").val().length > 50) {
              alert("意見最多填寫50字");
            } else {
              var satisfied_value = $('input[name="Satisfied"]:checked').data(
                "satisfiedvalue"
              );
              $.ajax({
                url: "Common/ChatbotSatisfie.ashx",
                type: "POST",
                data: {
                  s: 0,
                  satisfie: satisfied_value,
                  unsatisfie: $("#txt_satisfied").val(),
                },
              });
              alert("感謝您寶貴的意見");
              $(".informationBlock>div").hide();
              $("#txt_satisfied").val("");
              this.isinformation = !this.isinformation;
            }
          },
          satisfiedCancel: function () {
            this.isinformation = !this.isinformation;
          },
          getCookie: function (name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(";").shift();
          },
          append: function (text) {
            $("#words").append(text);
            var objDiv = document.getElementById("words");
            objDiv.scrollTop = objDiv.scrollHeight;
          },
          //詢問人生大事
          getLifeEvent: function (
            des = "請問您目前尋找的服務是哪個人生階段呢?"
          ) {
            var str =
              '<div class="atalk"><span class="dialog">' +
              des +
              "<br/></span></div>";
            this.append(str);
            this.liftevent();
          },
          render: function () {
            //歡迎句
            var odj =
              '<div class="atalk"><span class="dialog">Hi！歡迎來到我的E政府，我是E-GOV小幫手。您可以在對話視窗右上方設定字體大小及身分角色，讓我有機會為您提供更適切的服務。請問有甚麼能讓我為您服務的呢？<span class="time">04:00:39</span></span></div><div class="service_list"><div class="title">資訊快遞</div><ul><li><a href="News_Content.aspx?n=37&amp;s=643710&amp;sms=9100" target="_blank" title="迎接國境解封，出入境注意事項總整理！"> <span>迎接國境解封，出入境注意事項總整理！</span> </a></li></ul></div>';
            this.append(odj);
            //需用箭頭函式
            setTimeout(() => {
              this.getLifeEvent("請從人生階段中選擇政府申辦服務！");
            }, 1000);
          },
          TalkSub: function () {
            var TalkWords = document.getElementById("talkwords");
            //定義空字串
            var str = "";
            if (this.Q_Now == "") {
              // 訊息為空時彈窗
              alert("訊息不能為空");
              return;
            }
            str =
              '<div class="btalk"><span class="dialog">' +
              this.Q_Now +
              this.getDateString() +
              "</span></div>";
            this.append(str);

            //var returntext;
            var searchword = this.Q_Now;
            if (this.guid == this.guid) {
              this.chatLogs.push(searchword);
            }
            this.Q_Now = "";
            //var temp = "";
            var apiobj;
            var servivecobj;
            var datas = {
              id: this.guid,
              chatLogs: this.chatLogs,
              Q_Now: searchword,
              prompt: "",
              similar_k: 3,
            };
            //查詢
            $.ajax({
              type: "get",
              //data:datas,
              url: "./api.json",
              dataType: "json",
              //url: 'https://www.gov.tw/chatbotapi.aspx?type=check&s=' + searchword,
              cache: true,
              success: function (obj) {
                //  console.log(datas)
                apiobj = obj;
                servivecobj = obj.Source;
                var str =
                  '<div class="atalk"><span class="dialog">' +
                  vm.newline(apiobj.R) +
                  '<a class="talk_sub source" style="width:95%;margin:5px" onclick="vm.toggle(event)">資料來源</a><div style="display:none">';
                servivecobj.forEach(function (element, index) {
                  str +=
                    '<p style="margin:5px 0"><a class="lifeevent" style="color:#333 !important" href="' +
                    element.Link +
                    '" target="_blank" data-SN="' +
                    element.SN_Sub +
                    '" data-Name="' +
                    element.Title +
                    '">' +
                    (index + 1) +
                    "." +
                    element.Department +
                    ":" +
                    element.Title +
                    "</a></p>";
                });
                str +=
                  "</div><ul class='assess'><li><a onclick=\"vm.satisfylog($(this),'','','','1','" +
                  searchword +
                  "')\">滿意</a></li><li><a onclick=\"vm.satisfylog($(this),'','','','0','" +
                  searchword +
                  "')\">不滿意</a></li></ul><span style='position: absolute;font-size: 0.8rem;bottom: -20px;'>以上資訊由AI生成</span>" +
                  vm.getDateString() +
                  "</span></div>";
                vm.append(str);
              },
            });
          },
          //開啟/關閉資料來源
          toggle: function (event) {
            var target = event.currentTarget;
            //console.log(target.nextSibling)
            if (target.textContent == "資料來源") {
              target.textContent = "隱藏資料來源";
              target.nextSibling.setAttribute("style", "display:block");
            } else {
              target.textContent = "資料來源";
              target.nextSibling.setAttribute("style", "display:none");
            }
          },
          getDateString: function () {
            var date = new Date();
            var hour = date.getHours();
            if (date.getHours() < 10) {
              hour = "0" + date.getHours();
            }
            var minute = date.getMinutes();
            if (date.getMinutes() < 10) {
              minute = "0" + date.getMinutes();
            }
            var sec = date.getSeconds();
            if (date.getSeconds() < 10) {
              sec = "0" + date.getSeconds();
            }
            return (
              '<span class="time">' +
              hour +
              ":" +
              minute +
              ":" +
              sec +
              "</span>"
            );
          },
          //人生大事模板
          liftevent: function () {
            var objcomoponent = Vue.extend({
              created: function () {
                var that = this;
                $.ajax({
                  type: "get",
                  //url: 'https://www.gov.tw/chatbotapi.aspx?type=lifeeventlevel',
                  url: "./lifeeventlevel.json",
                  cache: true,
                  success: function (obj) {
                    that.lifeevent = obj;
                  },
                });
              },
              data() {
                return {
                  lifeevent: null,
                };
              },
              template: `<div  data-index="1" data-sitesmodulesn="1" data-margin_right="0" data-sort="2" data-bgcolor="#0000ffff" data-addparentgroup="False" data-groupsn="10478" data-widthdesktop="0" data-anchor="" data-tabtype="0" class="group-list marquee chat-marquee" data-margin_defaultsetting="false" data-type="4" data-bgclass="" data-widthmobile="0" data-groupname="" data-widthpad="0" data-margin_left="0" data-menuwidth="" data-isgroup="true" data-setlen="2" data-margin_bottom="0" data-child="8" data-margin_top="0" data-func="{\'marqueeHorizontal\':{\'auto\':false,\'delay\':5000,\'speed\':500}}"><div class="in"><div class="ct"><div class="in swiper">
                <ul data-index="1" data-child="8" style="margin-left: 0%;" class="swiper-wrapper">
                  <li v-for="(item,key) in lifeevent"  :key="key" class="swiper-slide">
                    <div class="life-block">
                      <img :src="'https://www.gov.tw/' + item.picurl" alt="" srcset="">
                      <div class="title" :data-SN="item.SN" :data-Name="item.Name">
                        {{item.Name}}
                      </div>
                      <ol>
                        <li v-for="(data,k) in item.ChildrenObj" :key="k">
                          <a class="lifeevent" href="#" :data-SN="data.SN" :data-Name="data.Name" @click="getlife" >{{data.Name}}</a>
                        </li>
                      </ol>
                    </div>
                  </li>
                </ul>
                <div class="swiper-button-next swiper-button-hide"></div>
                <div class="swiper-button-prev swiper-button-hide"></div>
              </div></div></div></div>`,
              methods: {
                getlife(e) {
                  var dataName = e.target.dataset.name;
                  var lep = e.target.dataset.sn;
                  $("#words").append(
                    '<div class="btalk"><span class="dialog">' +
                      dataName +
                      "" +
                      vm.getDateString() +
                      "</span></div>"
                  );
                  //第二層
                  var lifeeventobj;
                  $.ajax({
                    type: "GET",
                    url: "./lifeevent.json", //測試
                    dataType: "json",
                    success: function (data) {
                      lifeeventobj = data;
                      var str =
                        '<div class="atalk"><span class="dialog">請問您目前尋找的服務是屬於哪一個主題呢?<br/><ul>';
                      lifeeventobj.forEach(function (element) {
                        str +=
                          '<li><a class="lifeeventsec" href="#" lep="' +
                          lep +
                          '" data-SN="' +
                          element.SN +
                          '"  data-Name="' +
                          element.Name +
                          '">' +
                          element.Name +
                          "</a></li>";
                      });
                      str += "</ul>" + vm.getDateString() + "</span></div>";
                      $("#words").append(str);
                      //第三層
                      $(".lifeeventsec").click(function () {
                        $("#words").append(
                          '<div class="btalk"><span class="dialog">' +
                            $(this).attr("data-Name") +
                            vm.getDateString() +
                            "</span></div>"
                        );
                        var lifeeventobj;
                        var lep = $(this).attr("lep");
                        var parentSN = $(this).attr("data-SN");
                        $.ajax({
                          type: "GET",
                          url: "./lifeeventsec.json", //測試
                          dataType: "json",
                          success: function (data) {
                            lifeeventobj = data;

                            if (
                              lifeeventobj != undefined &&
                              lifeeventobj.length > 0
                            ) {
                              var str =
                                '<div class="atalk"><span class="dialog">也許下列會有您需要的服務?<br/><ul>';
                              lifeeventobj.forEach(
                                (element) =>
                                  (str +=
                                    '<li><a class="lifeeventsec" target="_blank" href="' +
                                    element.url +
                                    '" data-SN="' +
                                    element.SN +
                                    '"  data-Name="' +
                                    element.Name +
                                    '">' +
                                    element.Name +
                                    "<span>" +
                                    element.dep +
                                    "</span></a></li>")
                              );
                              str +=
                                '</ul><a target="_blank" href="News_LifeEvent.aspx?lep=' +
                                lep +
                                "&le=" +
                                parentSN +
                                '" title="更多服務" class="talk_sub btnmore" >更多服務</a><br/>或查詢其他服務關鍵字。' +
                                vm.getDateString() +
                                "</span></div>";
                              $("#words").append(str);
                              var satisfy =
                                '<div class="atalk"><span class="dialog ">對這次服務滿意嗎?<ul class="evaluate"><li><a onclick=\'vm.satisfylog($(this),"",' +
                                lep +
                                "," +
                                parentSN +
                                ',"1","")\'>滿意</a></li><li><a onclick=\'vm.satisfylog($(this),"",' +
                                lep +
                                "," +
                                parentSN +
                                ',"0","")\'>不滿意</a></li></ul></span></div>';
                              $("#words").append(satisfy);
                            } else {
                              var time = new Date().getTime();
                              $("#words").append(
                                '<div class="atalk"><span class="dialog">不好意思！目前無相關服務，歡迎進一步至<a target="_blank" style="color: #2453ff !important;text-decoration: underline !important" href="https://www.service.gov.tw/user_qa_desc.php">線上客服中心</a>提問諮詢。' +
                                  vm.getDateString() +
                                  "</span></div>"
                              );
                            }
                          },
                          error: function (xhr) {
                            console.log(xhr.status);
                          },
                        });
                      });
                    },
                    error: function (xhr) {
                      console.log(xhr.status);
                    },
                  });
                },
              },
            });
            var obj = new objcomoponent().$mount();
            this.append(obj.$el);
          },
          newGuid: function () {
            var guid = "";
            for (var i = 1; i <= 32; i++) {
              var n = Math.floor(Math.random() * 16.0).toString(16);
              guid += n;
              if (i == 8 || i == 12 || i == 16 || i == 20) guid += " - ";
            }
            return guid;
          },
          //判斷換行
          newline: function (text) {
            var re = /(\d+.)/g;
            return text.replace(re, "<br>$1");
          },
          //未處理
          satisfylog: function (a, s, lep, l, type, text) {
            console.log($(a));
            if ($(a).parent().parent().find(".is-active").length == 0) {
              $(a).addClass("is-active");
              $.ajax({
                type: "get",
                url:
                  "https://www.gov.tw/chatbotlogapi.aspx?type=satisfy&s=" +
                  s +
                  "&lep=" +
                  lep +
                  "&l=" +
                  l +
                  "&t=" +
                  type +
                  "&text=" +
                  text,
                cache: true,
                async: false,
                success: function (obj) {
                  console.log("s:" + s);
                  console.log("lep:" + lep);
                  console.log("l:" + l);
                  console.log("type:" + type);
                },
              });
            }
          },
          AutoComplete: function (inp, arr) {
            inp.addEventListener("input", function (e) {
              var a,
                b,
                i,
                val = this.value;
              closeAllLists();
              if (!val) {
                return false;
              }
              currentFocus = -1;
              a = document.createElement("DIV");
              a.setAttribute("id", this.id + "autocomplete-list");
              a.setAttribute("class", "autocomplete-items");
              this.parentNode.insertBefore(a, this.parentNode.firstChild);
              for (i = 0; i < arr.length; i++) {
                if (
                  arr[i].substr(0, val.length).toUpperCase() ==
                  val.toUpperCase()
                ) {
                  b = document.createElement("DIV");
                  b.innerHTML =
                    "<strong>" + arr[i].substr(0, val.length) + "</strong>";
                  b.innerHTML += arr[i].substr(val.length);
                  b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                  b.addEventListener("click", function (e) {
                    inp.value = this.getElementsByTagName("input")[0].value;
                    closeAllLists();
                  });
                  a.appendChild(b);
                }
              }
            });
            inp.addEventListener("keydown", function (e) {
              var x = document.getElementById(this.id + "autocomplete-list");
              if (x) x = x.getElementsByTagName("div");
              if (e.keyCode == 40) {
                currentFocus++;
                addActive(x);
              } else if (e.keyCode == 38) {
                currentFocus--;
                addActive(x);
              } else if (e.keyCode == 13) {
                e.preventDefault();
                if (currentFocus > -1) {
                  if (x) x[currentFocus].click();
                }
              }
            });
            function addActive(x) {
              if (!x) return false;
              removeActive(x);
              if (currentFocus >= x.length) currentFocus = 0;
              if (currentFocus < 0) currentFocus = x.length - 1;
              x[currentFocus].classList.add("autocomplete-active");
            }
            function removeActive(x) {
              for (var i = 0; i < x.length; i++) {
                x[i].classList.remove("autocomplete-active");
              }
            }
            function closeAllLists(elmnt) {
              var x = document.getElementsByClassName("autocomplete-items");
              for (var i = 0; i < x.length; i++) {
                if (elmnt != x[i] && elmnt != inp) {
                  x[i].parentNode.removeChild(x[i]);
                }
              }
            }
            document.addEventListener("click", function (e) {
              closeAllLists(e.target);
            });
          },
          inactivityTime: function () {
            var t;
            var t2;
            resetTimer();
            $(".talk_con")
              .find("a,input")
              .click(function () {
                console.log($(this));
                resetTimer();
              });
            function logout() {
              var Rolevalues = new Array();
              $.each($(".user li input:checked"), function () {
                Rolevalues.push($(this).val());
              });
              $.ajax({
                type: "get",
                url:
                  "https://www.gov.tw/chatbotapi.aspx?type=idlerecommend&role=" +
                  Rolevalues.toString(),
                cache: true,
                success: function (obj) {
                  append(obj);
                },
              });
              setTimeout(function () {
                getLifeEvent("本站針對熱門服務做了一些分類");
              }, 1000);
            }
            function closewindow() {
              $(".CustomerService").show();
              $(".talk_con").hide();
            }
            function resetTimer() {
              console.log("reset");
              clearTimeout(t);
              clearTimeout(t2);
              var sessionTimeoutWarning = 2; //min
              var sTimeout = parseInt(sessionTimeoutWarning) * 60 * 1000;
              t = setTimeout(logout, sTimeout);
              var sessionTimeoutWarning2 = 10; //min
              var sTimeout2 = parseInt(sessionTimeoutWarning2) * 60 * 1000;
              t2 = setTimeout(closewindow, sTimeout2);
            }
          },
        },
        computed: {
          fontSizeStyle() {
            return {
              fontSize: `${this.fontSize}`,
            };
          },
        },
        mounted: function () {
          this.render();
          this.guid = this.newGuid();
          $("#tempwords").hide();

          //頁面載入等待
          $(window).ajaxStart(function () {
            $("#tempwords").show();
            $("#tempwords").append(
              '<div class="atalk"><span class="dialog temploading" style="height: 25px;width: 105px;"><div>AI生成中</div><div class="typing-loader"></div></span></div>'
            );
            var objDiv = document.getElementById("words");
            objDiv.scrollTop = objDiv.scrollHeight;
          });
          $(window).ajaxStop(function () {
            $(".temploading").parent().remove();
            $("#tempwords").hide();
          });

          //文字建議帶入
          //var autocompleteurl = "https://www.gov.tw/chatbotapi.aspx?type=autocomplete";
          $.ajax({
            type: "get",
            //url: autocompleteurl,
            url: "./autocomplete.json",
            cache: true,
            success: function (obj) {
              vm.AutoComplete(document.getElementById("talkwords"), obj);
            },
          });
        },
        watch: {
          isinformation: function () {
            if (this.isinformation == false) {
              $(".informationBlock>div").hide();
            }
          },
          isebookicon: function () {
            if (this.isebookicon == false) {
              this.istalkcon == false;
            }
          },
          deep: true,
        },
      });

      vm.$mount(".sys-root");
    </script>

    <!-- Initialize Swiper -->
    <script>
      setTimeout(() => {
        var swiper = new Swiper(".swiper", {
          slidesPerView: 2,
          spaceBetween: 8,
          navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
          },
        });
        var container = document.querySelector(".swiper");
        container.addEventListener("mouseenter", function () {
          $(".swiper-button-next").removeClass("swiper-button-hide"),
            $(".swiper-button-prev").removeClass("swiper-button-hide");
        });
        container.addEventListener("mouseleave", function () {
          $(".swiper-button-next").addClass("swiper-button-hide"),
            $(".swiper-button-prev").addClass("swiper-button-hide");
        });
      }, 1000);
    </script>

    <style>
      /*swiper 客製樣式*/
      .swiper-button-prev {
        background-image: url(https://www.gov.tw/Images/icon-pic/away-b-left.png?1595239851);
      }
      .swiper-button-next {
        background-image: url(https://www.gov.tw/Images/icon-pic/away-b-right.png?1595239824);
      }
      .swiper-button-next,
      .swiper-button-prev {
        background-repeat: no-repeat;
        background-position: center;
        opacity: 0.7;
        background-color: #fff;
        width: 42px;
        height: 42px;
        transition: 150ms;
        border-radius: 50%;
        box-shadow: 0px 0px 3px #ccc !important;
        border: none !important;
        top: 37%;
      }
      .swiper-button-next:after,
      .swiper-button-prev:after {
        content: "";
      }
      .swiper-button-hide {
        display: none;
      }
      /*swiper 客製樣式 結束*/

      .area-editor .ct img {
        max-width: 100% !important;
      }
      .chat-marquee .ct li .life-block img {
        max-width: 100% !important;
      }
      .group-list.marquee > .in > .ct > .in {
        overflow: hidden;
      }
      .group-list.marquee > .in {
        margin-top: 0px !important;
        margin-bottom: 0px !important;
      }
      .information .box ul li a {
        cursor: pointer;
      }
      /*資料來源按鈕樣式*/
      .source {
        width: 95px;
        margin: 5px;
      }
      /*對話框-滿意度樣式*/
      .evaluate {
        display: flex;
      }
      .evaluate li {
        width: 50%;
      }
      .evaluate li a {
        font-size: 0;
        height: 50px;
        width: 50px;
        box-sizing: border-box;
        margin: 0 auto;
        border-radius: 50px !important;
        cursor: pointer;
        border: none !important;
        background-size: 30% !important;
      }
      .evaluate li:nth-child(1) a {
        background: url(https://www.gov.tw/Images/like.png) no-repeat center
          #98e0b2;
      }
      .evaluate li:nth-child(2) a {
        background: url(https://www.gov.tw/Images/unlike.png) no-repeat center
          #ffbfb4;
      }

      /*時間-滿意度樣式*/
      .assess {
        position: absolute;
        bottom: -33px;
        right: 35px;
        display: flex;
      }
      .assess li {
        padding: 2px !important;
      }
      .assess li a {
        font-size: 0;
        height: 25px;
        width: 25px;
        box-sizing: border-box;
        padding: 0 !important;
        border-radius: 50% !important;
        cursor: pointer;
        border: none !important;
        background-size: 50% !important;
      }
      .assess li:nth-child(1) a {
        background: url(https://www.gov.tw/Images/like.png) no-repeat center
          #98e0b2;
      }
      .assess li:nth-child(2) a {
        background: url(https://www.gov.tw/Images/unlike.png) no-repeat center
          #ffbfb4;
      }

      .talk_word {
        width: calc(100% - 82px);
      }
    </style>
  </body>
</html>
